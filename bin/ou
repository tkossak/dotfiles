#!/usr/bin/env python3

# unquote link and open it in new tab

import webbrowser
import urllib.parse
import argparse
import pyperclip

parser = argparse.ArgumentParser()
parser.add_argument('url', nargs='?', default=pyperclip.paste())
args = parser.parse_args()

res = urllib.parse.parse_qsl(args.url)
ile = 0
for k, v in res:
    v = urllib.parse.unquote(v)
    if v.startswith('https://') or v.startswith('http://'):
        print('Starting url: {}'.format(v))
        webbrowser.open_new_tab(v)
        ile += 1
        if ile >= 5:
            print('Found more than 5 urls, stopping.')
            break

if ile == 0:
    print('No urls found')
