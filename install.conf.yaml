- clean: ['~']

- shell:
    - mkdir -p ~/apps
    - mkdir -p ~/apps/dotfiles.local
    - find bin -type f -not -name 'create_bash.model' -exec chmod +x {} \;
    - command: '[ -f ~/.tmux.conf -a ! -L ~/.tmux.conf ] && mv ~/.tmux.conf ~/.tmux.conf.old || true'
    - command: '[ -f ~/.vimrc -a ! -L ~/.vimrc ] && mv ~/.vimrc ~/.vimrc.old || true'
    - command: '[ -f ~/.vimrc.local -a ! -L ~/.vimrc.local ] && mv ~/.vimrc.local ~/.vimrc.local.old || true'
    - command: '[ -f ~/.bashrc -a ! -L ~/.bashrc ] && mv ~/.bashrc ~/.bashrc.old || true'
    - command: '[ -f ~/.bashrc.local -a ! -L ~/.bashrc.local ] && mv ~/.bashrc.local ~/.bashrc.local.old || true'
    - command: '[ -f ~/.emacs -a ! -L ~/.emacs ] && mv ~/.emacs ~/.emacs.old || true'
    - command: '[ -f ~/.emacs.d/mine/.emacs.local -a ! -L ~/.emacs.d/mine/.emacs.local ] && mv ~/.emacs.d/mine/.emacs.local ~/.emacs.d/mine/.emacs.local.old || true'
    - command: '[ -f ~/.gitconfig -a ! -L ~/.gitconfig ] && mv ~/.gitconfig ~/.gitconfig.old || true'
    - command: '[ -f ~/.gitconfig.local -a ! -L ~/.gitconfig.local ] && mv ~/.gitconfig.local ~/.gitconfig.local.old || true'

- link:
    ~/.dotfiles: ''
    ~/.dotfiles.local: ../dotfiles.local/
    ~/.vimrc:
        path: vimrc
        relink: true
    ~/.tmux.conf:
        path: tmux.conf
        relink: true
    ~/.bashrc:
        path: bashrc
        relink: true
    ~/.emacs:
        relink: true
        path: emacs
    ~/.gitconfig:
        path: gitconfig
        relink: true

    ~/.vimrc.local:
        path: ../dotfiles.local/vimrc.local
        relink: true
    ~/.bashrc.local:
        path: ../dotfiles.local/bashrc.local
        relink: true
    ~/.emacs.d/mine/.emacs.local:
        create: true
        path: ../dotfiles.local/emacs.local
        relink: true
    ~/.gitconfig.local:
        path: ../dotfiles.local/gitconfig.local
        relink: true

- shell:
    - ["git submodule update --init --recursive", "Installing submodules"]
    - vim +PluginInstall +PluginClean +qall

