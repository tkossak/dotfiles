- clean: ['~', '~/.emacs.d/mine', '~/.config/ranger']

- shell:
    - mkdir -p ~/apps
    - mkdir -p ~/apps/dotfiles.local
    - find bin -type f -not -name 'create_bash.model' -exec chmod +x {} \;
    - command: '[[ -f ~/.tmux.conf && ! -L ~/.tmux.conf ]] && mv ~/.tmux.conf ~/.tmux.conf.old || true'
    - command: '[[ -f ~/.vimrc && ! -L ~/.vimrc ]] && mv ~/.vimrc ~/.vimrc.old || true'
    - command: '[[ -f ~/.vimrc.local && ! -L ~/.vimrc.local ]] && mv ~/.vimrc.local ~/.vimrc.local.old || true'
    - command: '[[ -f ~/.bashrc && ! -L ~/.bashrc ]] && mv ~/.bashrc ~/.bashrc.old || true'
    - command: '[[ -f ~/.bashrc.local && ! -L ~/.bashrc.local ]] && mv ~/.bashrc.local ~/.bashrc.local.old || true'
    - command: '[[ -f ~/.emacs && ! -L ~/.emacs ]] && mv ~/.emacs ~/.emacs.old || true'
    - command: '[[ -f ~/.emacs.d/mine/.emacs.local && ! -L ~/.emacs.d/mine/.emacs.local ]] && mv ~/.emacs.d/mine/.emacs.local ~/.emacs.d/mine/.emacs.local.old || true'
    - command: '[[ -f ~/.gitconfig && ! -L ~/.gitconfig ]] && mv ~/.gitconfig ~/.gitconfig.old || true'
    - command: '[[ -f ~/.gitconfig.local && ! -L ~/.gitconfig.local ]] && mv ~/.gitconfig.local ~/.gitconfig.local.old || true'
    - command: '[[ -f ~/.config/ranger/rc.conf && ! -L ~/.config/ranger/rc.conf ]] && mv ~/.config/ranger/rc.conf ~/.config/ranger/rc.conf.old || true'
    - command: '[[ -f ~/.config/ranger/rifle.conf && ! -L ~/.config/ranger/rifle.conf ]] && mv ~/.config/ranger/rifle.conf ~/.config/ranger/rifle.conf.old || true'

- link:
    ~/.dotfiles: ''
    ~/.dotfiles.local: ../dotfiles.local/
    ~/.vimrc:
        path: vimrc
        relink: true
    ~/.tmux.conf:
        path: tmux.conf
        relink: true
    ~/.bashrc:
        path: bashrc
        relink: true
    ~/.emacs:
        relink: true
        path: emacs
    ~/.gitconfig:
        path: gitconfig
        relink: true
    ~/.config/ranger/rc.conf:
        path: rc.conf
        create: true
        relink: true
    ~/.config/ranger/rifle.conf:
        path: rifle.conf
        create: true
        relink: true

    ~/.vimrc.local:
        path: ../dotfiles.local/vimrc.local
        relink: true
    ~/.bashrc.local:
        path: ../dotfiles.local/bashrc.local
        relink: true
    ~/.emacs.d/mine/.emacs.local:
        create: true
        path: ../dotfiles.local/emacs.local
        relink: true
    ~/.gitconfig.local:
        path: ../dotfiles.local/gitconfig.local
        relink: true

- shell:
    - ./install_finalize
    - ["git submodule update --init --recursive", "Installing submodules"]
    - vim +PluginInstall +PluginClean +qall

